<div class="row" id="user-info-bar">
	<div class="ie-bg"></div>
	<div class="width-wrap">
		<div class="user-avatar-block">
			<div id="user-info-bar-user-avatar"></div>
        </div>
        <div class="user-info-block"></div>
    </div>
    <script type="text/javascript">
        (function () {
            var avatar = new AvatarController($('#user-info-bar-user-avatar')[0], {
                disableOldIEMask: false
            });

                avatar.update('../images/_temp/fake-avatar-3.png');

            setTimeout(function () {
                avatar.update('../images/_temp/fake-avatar-1.png');
            }, 1000);

            setTimeout(function () {
                avatar.update('../images/_temp/fake-avatar-2.jpg');
            }, 2000);

            setTimeout(function () {
                avatar.update('../images/_temp/fake-avatar-5.jpg');
            }, 3000);





            function AvatarController(avatarContainer, options) {
                if (!avatarContainer) return undefined;

                var avatarElementClassName = 'avatar';
                var avatarBordersElementClassName = 'avatar-borders';
                var avatarIframeSrc = 'user-avatar.html';


                options = options || {};

                var filtersEnabled = typeof avatarContainer.filters === 'object'
                    && navigator.userAgent.search(' MSIE 8.0') > 0
                    && !options.disableOldIEMask
                ;

                var avatarELement, avatarBordersElement, avatarIframeForOldIE;


                init.call(this);


                this.update = function (imageUri) {
                    update.call(this, imageUri);
                }

                function init() {
                    avatarELement = $(avatarContainer).find('.'+avatarElementClassName)[0];
                    avatarBordersElement = $(avatarContainer).find('.'+avatarBordersElementClassName)[0];
                    avatarIframeForOldIE = $(avatarContainer).find('iframe')[0];

                    if (!filtersEnabled) {
                        // we are going to use background image
                        if (avatarIframeForOldIE) {
                            // avatarIframeForOldIE.style.display = 'none';
                            avatarIframeForOldIE.parentNode.removeChild(avatarIframeForOldIE);
                        }

                        if (!avatarELement) {
                            // console.log('Creating avatarELement...');
                            avatarELement = document.createElement('DIV');
                            avatarELement.className = avatarElementClassName;
                            avatarContainer.appendChild(avatarELement);
                        }

                        if (!avatarBordersElement) {
                            // console.log('Creating avatarBordersElement...');
                            avatarBordersElement = document.createElement('DIV');
                            avatarBordersElement.className = avatarBordersElementClassName;
                            avatarContainer.appendChild(avatarBordersElement);
                        }

                        return;
                    }

                    if (avatarELement) avatarELement.style.display = 'none';
                    if (avatarBordersElement) avatarBordersElement.style.display = 'none';

                    if (!avatarIframeForOldIE) {
                        // console.log('Creating avatarIframeForOldIE...');
                        avatarIframeForOldIE = document.createElement('IFRAME');
                        avatarIframeForOldIE.src = avatarIframeSrc;
                        avatarIframeForOldIE.setAttribute('frameborder', '0');
                        avatarIframeForOldIE.setAttribute('scrolling', 'no');
                        avatarContainer.appendChild(avatarIframeForOldIE);
                    }
                }

                function update(imageUri) {
                    if (!filtersEnabled) {
                        avatarELement.style.backgroundImage = 'url('+imageUri+')';
                        return;
                    }

                    if (avatarIframeForOldIE) {
                        avatarIframeForOldIE.src = avatarIframeSrc+'?avatarImage='+encodeURIComponent(imageUri);
                    }
                }
            }
        })();
    </script>
</div>